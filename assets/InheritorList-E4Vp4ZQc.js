import{_ as M}from"./_plugin-vue_export-helper-DD8xY_cn.js";/* empty css              */import{P as T}from"./index-BglYEMXj.js";import{L as q}from"./index-CkegTuBI.js";import{S as E}from"./index-CTgKTHZN.js";import{N as W}from"./index-DGW9jjqF.js";import{d as G,u as H,r as n,c as J,o as K,a as d,b as v,h as _,e as t,w as I,I as O,F as L,j as S,l as Q,t as m,x as N,k as A,y as X,s as B}from"./index-vRdIfHcb.js";import{l as Y,c as Z,n as ee}from"./noChoose-UWr-mhCs.js";import"./use-route-kyBRzsv2.js";import"./use-id-Cv-JJh97.js";const ae={class:"intangible-heritage-container"},se={class:"scroll-content"},te={class:"filter-section"},oe=["onClick"],ne=["src"],le={class:"content"},re={class:"count"},ce={class:"label"},ie={class:"project-list"},ue=["onClick"],de={class:"img-box"},ve=["src"],_e={class:"info-box"},me={class:"title van-ellipsis"},fe={class:"tag-row"},he={class:"tag"},pe={class:"address-row"},ge=["src"],ye={class:"address"},ke=G({__name:"InheritorList",setup(be){const w=H(),y=n([]),i=n(!1),u=n(!1),r=n(!1),k=n(!1),f=n(1),b=n(""),h=n("all"),p=n([{id:"all",name:"全部",count:0},{id:"national",name:"国家级",count:0},{id:"provincial",name:"省级",count:0},{id:"city",name:"市级",count:0},{id:"district",name:"区县级",count:0}]),V=J(()=>{const e=p.value.find(s=>s.id===h.value);return e?e.name:"全部"}),D=()=>w.back(),R=e=>{h.value=e,B(`切换分类: ${e}`),g()},x=async()=>{try{if(k.value&&!r.value&&f.value>1){i.value=!1,k.value=!1;return}r.value&&(y.value=[],r.value=!1,f.value=1);const e=V.value==="全部"?"":V.value,s=await A.inheritor.getInheritorPage(f.value,e,b.value);if(s.code===1200&&Array.isArray(s.data)){const l=s.data||[];y.value.push(...l),f.value++,l.length===0&&(u.value=!0)}else u.value=!0}catch(e){console.error("获取传承人列表失败:",e),u.value=!0}finally{i.value=!1}},g=()=>{u.value=!1,i.value=!0,r.value=!0,k.value=!0,x()},$=e=>{const s=String(e.id||"");s&&w.push({path:"/inheritor-detail",query:{id:s}})},j=e=>Q(e||""),P=e=>{B(`搜索: ${e}`),g()},U=async()=>{try{const e=await A.inheritor.getInheritorTypeNum();if(e.code===1200&&Array.isArray(e.data)){const s={国家级:"national",省级:"provincial",市级:"city",区县级:"district"},l={};for(const o of e.data){const c=s[String(o.type)];c&&(l[c]=Number(o.num||0))}const C=["national","provincial","city","district"].reduce((o,c)=>o+Number(l[c]||0),0);p.value=p.value.map(o=>o.id==="all"?{...o,count:C}:{...o,count:Number(l[o.id]||0)})}}catch(e){console.error("获取分类数量失败:",e)}};return K(()=>{U(),g()}),(e,s)=>{const l=O,C=W,o=E,c=q,z=T;return v(),d("div",ae,[_(C,{title:"非遗传承人",border:!1,onClickLeft:D},{left:I(()=>[_(l,{name:"arrow-left",class:"back-icon"})]),_:1}),t("div",se,[t("div",te,[(v(!0),d(L,null,S(p.value,a=>(v(),d("div",{key:a.id,class:X(["filter-item",{active:h.value===a.id}]),onClick:F=>R(a.id)},[t("img",{src:h.value===a.id?N(Z):N(ee),class:"bg-img"},null,8,ne),t("div",le,[t("span",re,m(a.count),1),t("span",ce,m(a.name),1)])],10,oe))),128))]),_(o,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=a=>b.value=a),placeholder:"请输入搜索关键词",shape:"round",background:"transparent",class:"custom-search",onSearch:P},null,8,["modelValue"]),_(z,{modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=a=>r.value=a),onRefresh:g},{default:I(()=>[_(c,{loading:i.value,"onUpdate:loading":s[1]||(s[1]=a=>i.value=a),finished:u.value,"finished-text":"没有更多了","immediate-check":!1,onLoad:x},{default:I(()=>[t("div",ie,[(v(!0),d(L,null,S(y.value,a=>(v(),d("div",{class:"project-card",key:a.id,onClick:F=>$(a)},[t("div",de,[t("img",{src:j(a.image),loading:"lazy"},null,8,ve)]),t("div",_e,[t("div",me,m(a.name),1),t("div",fe,[t("span",he,m(a.level),1)]),t("div",pe,[t("img",{src:N(Y),class:"addr-icon"},null,8,ge),t("span",ye,m(a.region),1)])])],8,ue))),128))])]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])])}}}),De=M(ke,[["__scopeId","data-v-5e70c92f"]]);export{De as default};
