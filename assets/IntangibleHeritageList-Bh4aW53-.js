import{_ as F}from"./_plugin-vue_export-helper-DD8xY_cn.js";/* empty css              */import{P as M}from"./index-D3l5Gef1.js";import{L as T}from"./index-CIuWtqkf.js";import{S as E}from"./index-DqkjtCxn.js";import{N as W}from"./index-BfLQp_tC.js";import{d as G,u as J,r as n,m as K,c as O,o as Q,a as v,b as _,h as m,e as t,w as N,I as X,F as x,j as S,l as Y,t as r,x as w,k as R,y as Z,s as A}from"./index-D962PYms.js";import{l as ee,c as ae,n as te}from"./noChoose-UWr-mhCs.js";import"./use-route-BKCfEn5z.js";import"./use-id-D8cNzryV.js";const se={class:"intangible-heritage-container"},oe={class:"scroll-content"},ne={class:"filter-section"},le=["onClick"],ce=["src"],re={class:"content"},ie={class:"count"},ue={class:"label"},de={class:"project-list"},ve=["onClick"],_e={class:"img-box"},me=["src"],fe={class:"info-box"},he={class:"title van-ellipsis"},pe={class:"tag-row"},ge={class:"tag"},ye={class:"tag"},be={class:"address-row"},Ce=["src"],ke={class:"address"},Ne=G({__name:"IntangibleHeritageList",setup(we){const I=J(),y=n(""),b=n([]),i=n(!1),u=n(!1),l=n(!1),f=n(1),C=n(!1),B=K(),L=String(B.query.category||""),h=n("all"),H=O(()=>{const e=p.value.find(s=>s.id===h.value);return e?e.name:"全部"}),p=n([{id:"all",name:"全部",count:0},{id:"national",name:"国家级",count:0},{id:"provincial",name:"省级",count:0},{id:"city",name:"市级",count:0},{id:"district",name:"区县级",count:0}]),$=()=>I.back(),j=e=>{h.value=e,A(`切换分类: ${e}`),g()},D=e=>{A(`搜索: ${e}`),g()},V=async()=>{try{if(C.value&&!l.value&&f.value>1){i.value=!1,C.value=!1;return}l.value&&(b.value=[],l.value=!1,f.value=1);const e=await R.heritage.getHeritagePage(f.value,L,H.value,y.value);if(e.code===1200&&Array.isArray(e.data)){const s=e.data||[];b.value.push(...s),f.value++,s.length===0&&(u.value=!0)}else u.value=!0}catch(e){console.error("获取列表失败:",e),u.value=!0}finally{i.value=!1}};(async()=>{try{const e=await R.heritage.getHeritageTypeNum(L);if(e.code===1200&&Array.isArray(e.data)){const s={国家级:"national",省级:"provincial",市级:"city",区县级:"district"},d={};for(const o of e.data){const c=s[String(o.type)];c&&(d[c]=Number(o.num||0))}const k=["national","provincial","city","district"].reduce((o,c)=>o+Number(d[c]||0),0);p.value=p.value.map(o=>o.id==="all"?{...o,count:k}:{...o,count:Number(d[o.id]||0)})}}catch(e){console.error("获取分类数量失败:",e)}})();const g=()=>{u.value=!1,i.value=!0,l.value=!0,C.value=!0,V()};Q(()=>{g()});const P=e=>{const s=String(e.id||"");s&&I.push({path:"/intangible-heritage-detail",query:{id:s}})},U=e=>Y(e||"");return(e,s)=>{const d=X,k=W,o=E,c=T,q=M;return _(),v("div",se,[m(k,{title:"非遗项目",border:!1,onClickLeft:$},{left:N(()=>[m(d,{name:"arrow-left",class:"back-icon"})]),_:1}),t("div",oe,[t("div",ne,[(_(!0),v(x,null,S(p.value,a=>(_(),v("div",{key:a.id,class:Z(["filter-item",{active:h.value===a.id}]),onClick:z=>j(a.id)},[t("img",{src:h.value===a.id?w(ae):w(te),class:"bg-img"},null,8,ce),t("div",re,[t("span",ie,r(a.count),1),t("span",ue,r(a.name),1)])],10,le))),128))]),m(o,{modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=a=>y.value=a),placeholder:"请输入搜索关键词",shape:"round",background:"transparent",class:"custom-search",onSearch:D},null,8,["modelValue"]),m(q,{modelValue:l.value,"onUpdate:modelValue":s[2]||(s[2]=a=>l.value=a),onRefresh:g},{default:N(()=>[m(c,{loading:i.value,"onUpdate:loading":s[1]||(s[1]=a=>i.value=a),finished:u.value,"finished-text":"没有更多了","immediate-check":!1,onLoad:V},{default:N(()=>[t("div",de,[(_(!0),v(x,null,S(b.value,a=>(_(),v("div",{class:"project-card",key:a.id,onClick:z=>P(a)},[t("div",_e,[t("img",{src:U(a.image),loading:"lazy"},null,8,me)]),t("div",fe,[t("div",he,r(a.name),1),t("div",pe,[t("span",ge,r(a.level),1),t("span",ye,r(a.category),1)]),t("div",be,[t("img",{src:w(ee),class:"addr-icon"},null,8,Ce),t("span",ke,r(a.region),1)])])],8,ve))),128))])]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])])}}}),De=F(Ne,[["__scopeId","data-v-90974350"]]);export{De as default};
