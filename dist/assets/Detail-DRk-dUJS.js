import{_ as V}from"./_plugin-vue_export-helper-DD8xY_cn.js";/* empty css              */import{P as C}from"./index-DT2YFU2q.js";import{a as D,S as P}from"./index-DAl3pzu5.js";import{N as F}from"./index-DP1erQjE.js";import{d as L,u as M,m as T,r as h,c as _,a as p,b as m,h as v,w as f,I as $,e,F as O,j as q,f as z,t as r,s as y,k as G}from"./index-BLgdBt6Y.js";import{a as U}from"./function-call-CNRQHFmk.js";const X={class:"heritage-detail-container"},j={class:"detail-page"},H={class:"media"},J=["src","onClick"],K=["src"],Q={class:"info-panel"},W={class:"title"},Y={class:"meta"},Z={class:"meta-row"},ee={class:"meta-value"},te={class:"meta-row"},se={class:"meta-value"},ae={class:"meta-row"},oe={class:"meta-value"},ne={class:"meta-row"},le={class:"meta-value"},ie={class:"section"},re={class:"section-content"},ce=L({__name:"Detail",setup(de){const x=M(),w=T(),u=h(!1),b=h(!1),o=h(null),k=_(()=>String(w.query.id||"")),N=_(()=>String(w.query.title||"非遗项目")),E=_(()=>o.value?.name||N.value),A=()=>{x.back()},I=async()=>{try{if(b.value=!0,!k.value){y("缺少项目ID");return}const a=await G.heritage.getHeritageById(k.value);a.code===1200&&a.data?o.value=a.data:y(a.msg||"获取详情失败")}catch(a){console.error("获取非遗详情失败:",a),y("获取详情失败")}finally{b.value=!1}};I();const B=()=>{u.value=!0,I().finally(()=>{u.value=!1})},g=_(()=>{const a=o.value||{},t=Array.isArray(a.imgList)?a.imgList:[],i=[];if(t.length){const c=[...t].sort((s,n)=>{const d=Number(s?.sortOrder??Number.MAX_SAFE_INTEGER),l=Number(n?.sortOrder??Number.MAX_SAFE_INTEGER);return d-l});for(const s of c){const n=String(s?.image||"");if(!n)continue;const d=/\.(mp4|m3u8|avi|mov|webm)$/i.test(n);i.push({type:d?"video":"image",url:n})}}return i}),R=a=>{const t=g.value.filter(s=>s.type==="image").map(s=>s.url);if(!t.length)return;const i=g.value.map((s,n)=>s.type==="image"?n:-1).filter(s=>s>=0),c=Math.max(0,i.indexOf(a));U({images:t,startPosition:c})};return(a,t)=>{const i=$,c=F,s=P,n=D,d=C;return m(),p("div",X,[v(c,{title:E.value,fixed:"",placeholder:"","z-index":"999",border:!1,onClickLeft:A},{left:f(()=>[v(i,{name:"arrow-left",class:"back-icon"})]),_:1},8,["title"]),v(d,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),onRefresh:B},{default:f(()=>[e("div",j,[e("div",H,[v(n,{class:"media-swipe",autoplay:0},{default:f(()=>[(m(!0),p(O,null,q(g.value,(l,S)=>(m(),z(s,{key:`${l.type}-${S}`},{default:f(()=>[l.type==="image"?(m(),p("img",{key:0,src:l.url,class:"media-img",loading:"lazy",onClick:me=>R(S)},null,8,J)):(m(),p("video",{key:1,class:"media-video",src:l.url,controls:"",playsinline:"","webkit-playsinline":"",preload:"metadata"},null,8,K))]),_:2},1024))),128))]),_:1})]),e("div",Q,[e("h2",W,r(o.value?.name||N.value),1),e("div",Y,[e("div",Z,[t[1]||(t[1]=e("span",{class:"meta-label"},"类别：",-1)),e("span",ee,r(o.value?.category||"-"),1)]),e("div",te,[t[2]||(t[2]=e("span",{class:"meta-label"},"级别：",-1)),e("span",se,r(o.value?.level||"-"),1)]),e("div",ae,[t[3]||(t[3]=e("span",{class:"meta-label"},"属地：",-1)),e("span",oe,r(o.value?.region||"-"),1)]),e("div",ne,[t[4]||(t[4]=e("span",{class:"meta-label"},"保护单位：",-1)),e("span",le,r(o.value?.protectionUnit||"-"),1)])]),e("div",ie,[t[5]||(t[5]=e("h3",{class:"section-title"},"简介",-1)),e("p",re,r(o.value?.intro||"-"),1)])])])]),_:1},8,["modelValue"])])}}}),ye=V(ce,[["__scopeId","data-v-89a11aa9"]]);export{ye as default};
